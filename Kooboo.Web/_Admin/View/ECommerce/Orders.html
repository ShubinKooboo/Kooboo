<!-- #layout name=blank-->
<div id="app" v-cloak>
  <div class="page-header">
    <h1 class="title">Orders</h1>
    <div>
      <div class="input-group input-large pull-right">
        <input
          type="text"
          v-model="searchKey"
          @keyup.enter="searchStart"
          class="form-control"
          style="height: 32px;"
          placeholder="Keywords"
        />
        <div class="input-group-btn">
          <button class="btn btn-default" @click="searchStart"
            ><i class="fa fa-search"></i>Search</button
          >
        </div>
      </div>
    </div>
  </div>
  <kb-breadcrumb :breads="breads"></kb-breadcrumb>
  <div class="navbar navbar-default">
    <div class="container-fluid">
      <a
        class="btn btn-link disabled navbar-btn"
        v-if="isSearching"
        href="javascript:;"
        >Search result</a
      >
      <!-- <a :href="newOrder" v-else class="btn green navbar-btn">Add order</a> -->
      <a v-if="selected.length > 0" @click="onDelete" class="btn red navbar-btn"
        >Delete</a
      >
      <a
        v-if="isSearching"
        href="javascript:;"
        class="btn btn-default navbar-btn pull-right"
        @click="clearSearching"
        ><i class="fa fa-close"></i
      ></a>
    </div>
  </div>
  <kb-table :data="tableData" show-select :selected.sync="selected">
    <kb-table-column label="id">
      <template v-slot="row">
        <a :href="row.Edit.url" @click.stop>{{ row.id }}</a>
      </template>
    </kb-table-column>
    <kb-table-column
      label="email address"
      prop="emailAddress"
    ></kb-table-column>
    <kb-table-column label="telephone" prop="telephone"></kb-table-column>
    <kb-table-column label="status" prop="status"></kb-table-column>
    <kb-table-column label="totalAmount" prop="totalAmount"></kb-table-column>
    <kb-table-column
      label="contact number"
      prop="contactNumber"
    ></kb-table-column>
    <!-- <kb-table-column label="itemTotal" prop="itemTotal"></kb-table-column>
    <kb-table-column label="shippingCost" prop="shippingCost"></kb-table-column> -->
    <kb-table-column
      :label="Kooboo.text.common.date"
      prop="createDate"
    ></kb-table-column>
    <kb-table-column head-class="table-action" body-class="table-action">
      <template v-slot="row">
        <a class="btn btn-sm blue" :href="row.Edit.url" @click.stop>
          {{ row.Edit.text }}
        </a>
        <a class="btn btn-sm red" @click.stop="cancelOrder(row)" v-if="row.status === 'Created'"
          >Cancel</a
        >
        <a class="btn btn-sm green" @click.stop v-if="row.status === 'Paid'"
          >Ship</a
        >
      </template>
    </kb-table-column>
  </kb-table>
  <kb-pager
    :page-nr="pager.pageNr"
    :total-pages="pager.totalPages"
    @change="changePage"
  ></kb-pager>
</div>

<script>
  (function () {
    Kooboo.loadJS([
      "/_Admin/Scripts/components/kbTable.js",
      "/_Admin/Scripts/components/kbBreadcrumb.js",
      "/_Admin/Scripts/components/kbPager.js",
    ]);
  })();
</script>
<script src="/_Admin/View/ECommerce/Orders.js"></script>
<style>
  .table .table-action {
    width: 140px;
  }
  .table .table-action .btn {
    display: inline-block;
    margin: 0 2px;
  }
</style>
